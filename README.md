# 剪映草稿创建器

一个ComfyUI扩展，用于创建和管理剪映草稿文件。

## 功能特性

- **剪映草稿创建器**: 创建新的剪映草稿，支持自定义分辨率、帧率和项目设置
- **剪映草稿音频添加器**: 向现有剪映草稿添加背景音乐，自动限制音频时长

## 节点说明

### 1. 剪映草稿创建器

创建新的剪映草稿，包含基本的项目设置。

#### 输入参数

| 参数名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 草稿保存路径 | STRING | C:\Users\用户名\Documents\JianyingPro\Drafts | 剪映草稿保存路径，支持直接输入 |
| 项目名称 | STRING | 未命名项目 | 草稿项目的名称 |
| 视频文件路径 | STRING | 空 | 用于指定项目中使用的主视频文件路径 |
| 项目时长(秒) | FLOAT | 10.0 | 项目总时长，范围0.1-3600秒 |
| 分辨率 | 选择列表 | 1920x1080 | 项目分辨率，支持常见比例 |
| 帧率 | 选择列表 | 30 | 项目帧率，支持24/30/60fps |

#### 输出

- **UUID** - 创建的草稿的唯一标识符
- **草稿目录** - 创建的草稿文件夹的完整路径

### 2. 剪映草稿音频添加器

向现有剪映草稿添加背景音乐，自动读取草稿时长并限制音频长度。

#### 输入参数

| 参数名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 剪映草稿路径 | STRING | 空 | 剪映草稿文件夹路径，包含draft_meta_info.json和draft_content.json |
| 音频文件路径 | STRING | 空 | 背景音乐文件路径 |
| 音频时长限制 | FLOAT | 0 | 限制音频的最大时长，0表示使用草稿原时长 |
| 音频音量 | FLOAT | 0.8 | 背景音乐的音量（0-1） |

#### 输出

- **草稿目录** - 更新后的草稿文件夹路径
- **状态信息** - 操作状态或错误信息

## 使用方法

### 创建新草稿

1. 在ComfyUI中找到"剪映工具"类别
2. 添加"剪映草稿创建器"节点
3. 设置草稿保存路径
4. 配置项目名称、分辨率、帧率等参数
5. 运行节点创建草稿

### 添加背景音乐

1. 首先使用"剪映草稿创建器"创建草稿
2. 添加"剪映草稿音频添加器"节点
3. 输入剪映草稿路径（通常来自第一个节点的输出）
4. 输入音频文件路径
5. 可选：设置音频时长限制和音量
6. 运行节点添加背景音乐

## 示例工作流

### 完整工作流程

```
[剪映草稿创建器] 
        ↓ (草稿目录)
[剪映草稿音频添加器]
        ↓
[完成]
```

### 参数示例

- **草稿路径**: `C:\Users\用户名\Documents\JianyingPro\Drafts`
- **音频文件**: `C:\Music\background.mp3`
- **音频时长**: 使用草稿时长（设置为0）
- **音频音量**: 0.8

## 技术说明

### 文件结构

创建或修改的草稿包含以下文件：
- `draft_meta_info.json` - 草稿元数据
- `draft_content.json` - 草稿内容数据

### 音频时长限制

当音频时长限制设置为0时，系统会自动使用草稿中视频的最大时长作为音频时长。如果设置了具体数值，音频将被裁剪到该时长。

## 注意事项

1. 确保剪映已安装并正确配置
2. 草稿路径需要与剪映的草稿目录一致
3. 音频文件需要是剪映支持的格式（MP3、WAV等）
4. 修改现有草稿前建议备份原始文件
5. 路径输入支持Windows标准路径格式

## 更新日志

- v1.1.0: 添加剪映草稿音频添加器节点
- v1.0.0: 初始版本，支持创建剪映草稿